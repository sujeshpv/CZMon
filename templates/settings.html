{% extends "pe_base.html" %}

{% block content %}
<div class="card">
  <h2>Settings</h2>
  {% load static %}
  {% if msg %}
    <ul class="messages">
      <li class="{{ level }}">{{ msg }}</li>
    </ul>
  {% endif %}

  <div class="two-col">
    <div class="card">
      <h3>Add PC</h3>
      <form method="post">
        {% csrf_token %}
        <div>
          <label for="pc_name">PC Name</label>
          <input id="pc_name" name="pc_name" type="text" placeholder="Unique name for this PC" required />
        </div>
        <br/>
        <div>
          <label for="pc_ip">PC Virtual IP/FQDN</label>
          <input id="pc_ip" name="pc_ip" type="text" placeholder="e.g. 10.0.0.5" />
        </div>
        <div style="margin-top:8px">
          <button type="submit" name="add_pc">Add PC</button>
        </div>
      </form>

      <h4>Configured PCs</h4>
      <table id="pcs-list" style="width:100%;border-collapse:collapse">
        <thead>
          <tr><th style="width:2em">#</th><th>PC Name</th><th>PC Virtual IP/FQDN</th><th></th></tr>
        </thead>
        <tbody>
        {% for pc in pcs %}
          <tr data-ip="{{ pc.ip }}" data-name="{{ pc.name }}">
            <td>{{ forloop.counter }}</td>
            <td><strong>{{ pc.name }}</strong></td>
            <td>{{ pc.ip }}</td>
            <td>
              <form method="post" style="display:inline">
                {% csrf_token %}
                <input type="hidden" name="ip" value="{{ pc.ip }}" />
                <button type="submit" name="delete_pc" class="delete-x" title="Delete PC">✖</button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="4" class="muted">No PCs added</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card">
      <h3>Add PE</h3>
      <form method="post">
        {% csrf_token %}
        <div>
          <label for="pe_ip">PE Virtual IP/FQDN</label>
          <input id="pe_ip" name="pe_ip" type="text" placeholder="e.g. 10.0.0.8" />
        </div>
        <br/>
        <div>
          <label for="pe_name">PE Name </label>
          <input id="pe_name" name="pe_name" type="text" placeholder="Friendly name for PE" />
        </div>
        <div style="margin-top:8px">
          <button type="submit" name="add_pe">Add PE</button>
        </div>
      </form>

      <h4>Configured PEs</h4>
      <table id="pes-list" style="width:100%;border-collapse:collapse">
        <thead>
          <tr><th style="width:2em">#</th><th>PE Name</th><th>PE Virtual IP/FQDN</th><th></th></tr>
        </thead>
        <tbody>
        {% for p in pes %}
          <tr data-ip="{{ p.ip }}" data-name="{{ p.name }}">
            <td>{{ forloop.counter }}</td>
            <td>{% if p.name %}<strong>{{ p.name }}</strong>{% endif %}</td>
            <td>{{ p.ip }}</td>
            <td>
              <form method="post" style="display:inline">
                {% csrf_token %}
                <input type="hidden" name="ip" value="{{ p.ip }}" />
                <button type="submit" name="delete_pe" class="delete-x" title="Delete PE">✖</button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="4" class="muted">No PEs added</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
